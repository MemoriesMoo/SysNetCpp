# `unique_ptr` 的思路

## 概述

`unique_ptr` 是 C++ 标准库中的智能指针之一，用于管理独占拥有的对象。它确保在给定时间内只有一个指针可以拥有资源，从而避免资源泄漏。

## 主要特点

1. **独占性**: `unique_ptr` 不能被拷贝，只能通过移动来传递资源的所有权。这确保了资源的唯一拥有者。

2. **自动释放**: `unique_ptr` 负责管理资源的生命周期，当 `unique_ptr` 超出作用域或被显式销毁时，它会自动释放资源。

3. **轻量**: `unique_ptr` 是一个轻量级智能指针，不需要维护引用计数，不引入额外的开销。

## 实现思路

以下是实现 `unique_ptr` 的关键思路：

1. **构造函数**: 提供默认构造函数和接受指向资源的指针的构造函数。

2. **拷贝构造函数和赋值运算符**: 禁用拷贝构造函数和赋值运算符，以确保独占性。这可以通过将它们声明为删除函数来实现。

3. **移动构造函数和移动赋值运算符**: 允许资源的移动，通过接受另一个 `unique_ptr` 的右值引用，转移资源的所有权，然后将原始 `unique_ptr` 置为空。

4. **get() 函数**: 提供一个函数，以获取当前拥有的资源的指针。

5. **release() 函数**: 允许释放资源并返回资源指针，将当前 `unique_ptr` 置为空。

6. **reset() 函数**: 用于释放资源并将资源指针置为空。

7. **析构函数**: 当 `unique_ptr` 超出作用域时，析构函数会自动释放资源。

## 使用示例

```cpp
unique_ptr<int> ptr1(new int(42));  // 创建一个unique_ptr，拥有一个动态分配的int对象

unique_ptr<int> ptr2 = std::move(ptr1);  // 使用移动构造函数，ptr1现在为空，ptr2拥有资源

ptr2.reset();  // 释放ptr2的资源
```

`unique_ptr` 的主要思路是确保资源的独占性，通过禁用拷贝构造函数和赋值运算符，以及使用移动来传递资源的所有权，从而避免资源泄漏。它提供了一个轻量级的方式来管理资源生命周期，不引入引用计数的开销。